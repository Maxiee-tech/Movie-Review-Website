{% extends 'base.html' %}

{% block content %}
<h1>Welcome to MovieHub</h1>
<p>Discover movies, reviews, and more!</p>

<div id="latest-movies">
<div class="carousel-container">
    <div class="carousel-track">
        <img src="https://dnm.nflximg.net/api/v6/2DuQlx0fM4wd1nzqm5BFBi6ILa8/AAAAQVylBzU37ZpOJaV_EWOfGm7R3S6KJxdwj1KUgk7YQNg_vr7mSCnXzWJ7OaLdgqhKCGX2qeyrkWINXY_FJfoeRCsaIylCBHtQczT5GSpoHv7i0L0xCcQtXN4O8mAwzQZQqeUCXyLtVuwjlz50PCU66aV1.jpg?r=0f1" alt="Carousel 1">
        <img src="https://sm.ign.com/t/ign_nordic/feature/j/jurassic-w/jurassic-world-rebirth-forgot-that-it-was-is-and-always-will_qqsn.1280.jpg" alt="Carousel 2">
        <img src="https://filmquarterly.org/wp-content/uploads/2012/07/irobot_featured.jpg" alt="Carousel 3">
        <img src="https://unbelievable-facts.com/wp-content/uploads/2017/11/Kung-Fu-Hustle-Facts.jpg" alt="Carousel 4">
        <img src="https://imageio.forbes.com/blogs-images/markhughes/files/2016/01/13-Hours-Secret-Soldiers-of-Benghanzi-3-1200x698.png?format=png&height=900&width=1600&fit=bounds" alt="Carousel 5">
    </div>
    <div class="carousel-prev-img"></div>
    <div class="carousel-next-img"></div>
</div>
</div>
<script>
let carouselIndex = 0;
const images = document.querySelectorAll('.carousel-track img');
const prevDiv = document.querySelector('.carousel-prev-img');
const nextDiv = document.querySelector('.carousel-next-img');
const imgSrcs = Array.from(images).map(img => img.src);
function updateCarousel() {
    images.forEach((img, i) => {
        img.style.display = (i === carouselIndex) ? 'block' : 'none';
    });
    // Show previous image 10% from left, partially visible
    const prevIndex = (carouselIndex - 1 + images.length) % images.length;
    prevDiv.innerHTML = `<img src="${imgSrcs[prevIndex]}" style="position:absolute; left:-15%; top:0; width:130%; height:100%; max-height:100%; object-fit:cover; object-position: right; opacity:0.7; filter:blur(1px);">`;
    // Show next image 10% from right, partially visible
    const nextIndex = (carouselIndex + 1) % images.length;
    nextDiv.innerHTML = `<img src="${imgSrcs[nextIndex]}" style="position:absolute; right:-15%; top:0; width:130%; height:100%; max-height:100%; object-fit:cover; object-position: left; opacity:0.7; filter:blur(1px);">`;
}
updateCarousel();
setInterval(() => {
    carouselIndex = (carouselIndex + 1) % images.length;
    updateCarousel();
}, 1500);
</script>
<style>
    .carousel-container {
        width: 100%;
        max-width: 1200px;
        margin: 1rem auto 1rem auto;
        overflow: hidden;
        border-radius: 14px;
        box-shadow: 0 4px 24px rgba(0,0,0,0.25);
        background: #181818;
        height: 380px;
        position: relative;
    }
    .carousel-prev-img {
        position: absolute;
        left: 0;
        top: 0;
        width: 15%;
        height: 100%;
        z-index: 1;
        pointer-events: none;
        display: flex;
        align-items: center;
    }
    .carousel-next-img {
        position: absolute;
        right: 0;
        top: 0;
        width: 15%;
        height: 100%;
        z-index: 1;
        pointer-events: none;
        display: flex;
        align-items: center;
    }
    @media (max-width: 700px) {
        .carousel-container {
            height: 200px;
        }
        .carousel-prev-img,
        .carousel-next-img {
            width: 20%;
        }
    }
.carousel-track img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: none;
    position: absolute;
    left: 0;
    top: 0;
    border-radius: 14px;
    background: #181818;
}
.carousel-track img:first-child {
    display: block;
}
    position: absolute;
    left: 0;
    top: 0;
    border-radius: 14px;
}
.carousel-track img:first-child {
    display: block;
}
</style>

<section>
    <div id="latest-movies">
        <h2 style="margin-left: 0.5rem;">Latest Movies</h2>
    <ul style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 1.5rem; list-style: none; padding: 0; max-width: 1260px; margin: 0 auto;">
            {% for movie in movies %}
                <li style="text-align: center;">
                    {% if movie.poster %}
                        <a href="{% url 'movies:detail' movie.id %}">
                            <img src="{{ movie.poster.url }}" alt="{{ movie.title }} poster" style="width:170px; height:250px; object-fit:cover; display: block; margin: 0 auto 0.5rem auto; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.10);">
                        </a>
                    {% endif %}
                    <a href="{% url 'movies:detail' movie.id %}" style="display:block; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:170px; margin:0 auto;">
                        {{ movie.title|truncatechars:18 }}
                    </a>
                </li>
        {% empty %}
            <li>No movies found.</li>
        {% endfor %}
    </ul>
    </div>
</section><br>

<section>
    <div id="latest-movies">
    <h2>Latest Reviews</h2>
    <ul>
        <li>
            <strong>Inception</strong> - "A mind-bending thriller!" <em>~ by Alice</em>
        </li>
        <li>
            <strong>The Godfather</strong> - "A timeless classic." <em>~ by Bob</em>
        </li>
        <li>
            <strong>Interstellar</strong> - "Visually stunning and emotional." <em>by Carol</em>
        </li>
        <li>
            <strong>Parasite</strong> - "An extraordinary film that masterfully blends suspense, social commentary, and dark humor. The twists kept me on the edge of my seat throughout." <em>~ by Daniel</em>
        </li>
        <li>
            <strong>La La Land</strong> - "A beautiful homage to classic musicals with stunning visuals and a heartfelt story about dreams and love." <em>~ by Emily</em>
        </li>
        <li>
            <strong>Avengers: Endgame</strong> - "An epic conclusion to over a decade of storytelling. The action sequences were incredible, and the emotional payoff was well worth the wait." <em>~ by Frank</em>
        </li>
        <li>
            <strong>Spirited Away</strong> - "A magical journey filled with wonder and imagination. Miyazaki's masterpiece never fails to inspire." <em>~ by Grace</em>
        </li>
        <li>
            <strong>Joker</strong> - "A haunting and powerful performance by Joaquin Phoenix. The film offers a chilling look at society and mental health." <em>~ by Henry</em>
        </li>
    </ul>
</div>
</section><br>

<section>
    <div id="latest-movies">
    <h2>Join the Community</h2>
    <p>
    <a href="{% url 'users:register' %}">Sign up</a> or <a href="{% url 'users:login' %}">log in</a> to write your own reviews!
    </p>
</div>
</section>
{% endblock %}
